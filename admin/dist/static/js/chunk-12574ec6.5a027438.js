(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12574ec6"],{"127f":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("1da1"),r=(n("96cf"),n("9b15"));function c(e,t){return s.apply(this,arguments)}function s(){return s=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new r({accessKeyId:n.accessKeyId,accessKeySecret:n.accessKeySecret,stsToken:n.stsToken,region:n.region,bucket:n.bucket}),e.next=3,a.put(n.filepath,t);case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}},4658:function(e,t,n){"use strict";n("b0d3")},8697:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-button",{attrs:{type:"primary"},on:{click:e.handleAddCategory}},[e._v("添加分类")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(t){return e.onSyncCommon("category")}}},[e._v("推送分类")]),n("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.categoris,border:""}},[n("el-table-column",{attrs:{align:"center",label:"分类ID",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.cid)+" ")]}}])}),n("el-table-column",{attrs:{align:"center",label:"分类"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),n("el-table-column",{attrs:{align:"center",width:"200",label:"分类图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("img",{staticClass:"category-img",attrs:{src:e.row.img,alt:""}})]}}])}),n("el-table-column",{attrs:{label:"状态",align:"center","class-name":"status-col",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-tag",{attrs:{type:e._f("stateFilter")(a.state)}},[e._v(" "+e._s(1==a.state?"可见":0==a.state?"隐藏":"未知")+" ")])]}}])}),n("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return e.handleEdit(t)}}},[e._v("修改")]),0!=t.row.state?n("el-button",{attrs:{size:"small"},on:{click:function(n){return e.handleModifyState(t.row,"hidden")}}},[e._v(" 隐藏 ")]):e._e(),1!=t.row.state?n("el-button",{attrs:{size:"small",type:"success"},on:{click:function(n){return e.handleModifyState(t.row,"show")}}},[e._v(" 显示 ")]):e._e(),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){return e.handleDelete(t)}}},[e._v("删除")])]}}])})],1),n("el-dialog",{attrs:{visible:e.dialogVisible,title:"edit"===e.dialogType?"修改分类":"新增分类"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{attrs:{model:e.category,"label-width":"80px","label-position":"left"}},[n("el-form-item",{attrs:{label:"分类名称"}},[n("el-input",{attrs:{placeholder:"分类名称"},model:{value:e.category.name,callback:function(t){e.$set(e.category,"name",t)},expression:"category.name"}})],1),n("el-form-item",{attrs:{label:"分类图片"}},[n("div",{staticClass:"div-upload"},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:"web/oss/getAuth","show-file-list":!1,"http-request":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.category.img?n("img",{staticClass:"avatar",attrs:{src:e.category.img}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),n("p",[e._v("点击图片更换")])],1)])],1),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmCategory}},[e._v("确认")])],1)],1)],1)},r=[],c=n("1da1"),s=(n("a434"),n("99af"),n("b0c0"),n("96cf"),n("2ef0")),i=n.n(s),o=n("c405"),u=n("127f"),l=n("dd81"),d={cid:0,name:"",img:"",state:1},g={filters:{stateFilter:function(e){return 1==e?"success":0==e?"danger":"info"}},data:function(){return{categoris:[],category:Object.assign({},d),dialogVisible:!1,dialogType:"new",ossAuth:{authType:"admin"}}},components:{},computed:{},created:function(){this.getCategories()},methods:{getCategories:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["c"])();case 2:n=t.sent,e.categoris=n.data;case 4:case"end":return t.stop()}}),t)})))()},onSyncCommon:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(l["c"])({key:e});case 2:a=n.sent,t.$message({message:a.msg,type:a.res_code>0?"success":"error"});case 4:case"end":return n.stop()}}),n)})))()},handleAddCategory:function(){this.category=Object.assign({},d),this.dialogType="new",this.dialogVisible=!0},handleEdit:function(e){this.dialogType="edit",this.dialogVisible=!0,this.category=i.a.cloneDeep(e.row)},handleModifyState:function(e,t){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var r,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=i.a.cloneDeep(e),"hidden"==t?r.state=0:"show"==t&&(r.state=1),a.next=4,Object(o["e"])(r);case 4:c=0;case 5:if(!(c<n.categoris.length)){a.next=12;break}if(n.categoris[c].cid!==r.cid){a.next=9;break}return n.categoris.splice(c,1,Object.assign({},r)),a.abrupt("break",12);case 9:c++,a.next=5;break;case 12:n.$message({message:"操作成功",type:"success"}),e.state=r.state;case 14:case"end":return a.stop()}}),a)})))()},handleDelete:function(e){var t=this,n=e.$index,a=e.row;this.$confirm("确定删除当前分类?不可恢复！！！如仍需使用建议使用 “不显示” 功能","警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["b"])({cid:a.cid});case 2:t.categoris.splice(n,1),t.$message({type:"success",message:"删除成功!"});case 4:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e)}))},confirmCategory:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,a,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n="edit"===e.dialogType,!n){t.next=14;break}return t.next=4,Object(o["e"])(e.category);case 4:a=0;case 5:if(!(a<e.categoris.length)){t.next=12;break}if(e.categoris[a].cid!==e.category.cid){t.next=9;break}return e.categoris.splice(a,1,Object.assign({},e.category)),t.abrupt("break",12);case 9:a++,t.next=5;break;case 12:t.next=20;break;case 14:return t.next=16,Object(o["a"])(e.category);case 16:r=t.sent,c=r.data,e.category.cid=c,e.categoris.push(e.category);case 20:e.dialogVisible=!1,e.category.updateInfo=void 0,e.$notify({title:"成功",dangerouslyUseHTMLString:!0,message:"\n                    <div>分类id: ".concat(e.category.cid,"</div>\n                    <div>分类名称: ").concat(e.category.name,"</div>\n                "),type:"success"});case 23:case"end":return t.stop()}}),t)})))()},handleAvatarSuccess:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var a,r,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(o["d"])({authType:"goods-category",cid:0==t.category.cid?-1:t.category.cid});case 2:return a=n.sent,r=a.data,n.next=6,Object(u["a"])(e.file,r);case 6:c=n.sent,c.res&&200==c.res.status?(t.$notify({title:"上传完成",type:"success"}),t.category.img=c.url,console.log("--- upload ok ---"),console.log(c)):(t.$notify({title:"上传失败",type:"error"}),console.log("--- upload err ---"),console.log(c));case 8:case"end":return n.stop()}}),n)})))()},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,n=e.size/1024/1024<20;return t||this.$message.error("上传头像图片只能是 JPG 或 PNG 格式!"),n||this.$message.error("上传头像图片大小不能超过 20MB!"),t&&n}}},f=g,p=(n("4658"),n("2877")),m=Object(p["a"])(f,a,r,!1,null,"815a4b64",null);t["default"]=m.exports},b0d3:function(e,t,n){},c405:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o}));var a=n("b775");function r(e){return Object(a["a"])({url:"/admin/category/getCategory",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/admin/category/add",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/admin/category/update",method:"post",data:e})}function i(e){return Object(a["a"])({url:"/admin/category/delete",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/admin/oss/getAuth",method:"post",data:e})}},dd81:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var a=n("b775");function r(e){return Object(a["a"])({url:"/admin/sync/syncRush",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/admin/sync/syncShelves",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/admin/sync/celarAllUserBlackList",method:"post",data:e})}function i(e){return Object(a["a"])({url:"/admin/sync/clearAllUserPrivilege",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/admin/sync/syncCommon",method:"post",data:e})}}}]);